<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />
<title>MPQSに関するメモ</title>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<style type="text/css">
body { width: 740px; }
h2 { border-width: 0 0 1px 3px; border-style: solid; border-color: black; padding-left: 3px; }
</style>
</head>
<body>
<h1>素因数分解アルゴリズム MPQS に関する覚書</h1>

<h2>\(f(x) = x^2 - n\) の場合</h2>
\(x \approx \sqrt n\)<br />
\(\max f(x) \approx 2M \sqrt n + M^2\)<br />
\(\log{(\max f(x))} \approx \frac{\log{n}}{2} + \log{M}\)

<h2>\(F(x) = ax^2 + 2bx + c\), \((n = b^2 - ac)\) の場合</h2>
\(aF(x) = (ax + b)^2 - n\)<br />
\(x \approx -\frac{b}{a}\)<br />
\(\max F(x) \approx \frac{M}{\sqrt 2} \sqrt n\)<br />
\(\log{(\max F(x))} \approx \frac{\log{n}}{2} + \log{M}\)

<h2>\(F(x) = ax^2 + bx + c\), \((n = b^2 - 4ac)\) の場合</h2>
\(4aF(x) = (2ax + b)^2 - n\)<br />
\(x \approx -\frac{b}{2a}\)<br />
\(\max F(x) \approx \frac{M}{2 \sqrt 2} \sqrt n\)<br />
\(\log{(\max F(x))} \approx \frac{\log{n}}{2} + \log{M}\)

<h2>TODO</h2>
IO.popen のパイプによるRubyプロセス間でのバイナリデータの送受信<br />
 → マルチスレッド＆マルチプロセス化<br />

<h2>有効だった改良</h2>
・乗除算の削減（特にsieveの初期化）<br />
・多項式の係数を工夫（aを平方数とする）<br />
・パラメータの調整<br />
・適切なmultiplierの使用<br />
・2,3 での篩を行わない<br />
・複数の多項式に跨る大きな素因数の利用<br />
・試し割候補のみF(x)等を計算<br />
・Sieve&amp;gaussian_elimination&amp;GCDを一緒にループ<br />
・多項式のパラメータdを擬素数で良しとする<br />
・擬素数テストの前にクロネッカーシンボルを調べる（擬素数であるための必要条件）<br />

</body>
</html>
